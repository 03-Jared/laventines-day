<script>
    let currentQuestion = 0;

    function createHeart(x, y, duration) {
        const heart = document.createElement('div');
        heart.className = 'heart';
        heart.innerHTML = 'â¤';
        heart.style.left = x + 'px';
        heart.style.top = y + 'px';
        heart.style.animationDuration = duration + 's';
        document.body.appendChild(heart);
        setTimeout(() => heart.remove(), duration * 1000);
    }

    function createCat(x, y, duration) {
        const cat = document.createElement('div');
        cat.className = 'cat-emoji';
        cat.innerHTML = 'ðŸ±';
        cat.style.left = x + 'px';
        cat.style.top = y + 'px';
        cat.style.animationDuration = duration + 's';
        document.body.appendChild(cat);
        setTimeout(() => cat.remove(), duration * 1000);
    }

    function createFlower(x, y, duration) {
        const flower = document.createElement('div');
        flower.className = 'flower';
        flower.innerHTML = 'ðŸŒ¸';
        flower.style.left = x + 'px';
        flower.style.top = y + 'px';
        flower.style.animationDuration = duration + 's';
        document.body.appendChild(flower);
        setTimeout(() => flower.remove(), duration * 1000);
    }

    function createSparkle(x, y, duration) {
        const sparkle = document.createElement('div');
        sparkle.className = 'sparkle';
        sparkle.innerHTML = 'âœ¨';
        sparkle.style.left = x + 'px';
        sparkle.style.top = y + 'px';
        sparkle.style.animationDuration = duration + 's';
        document.body.appendChild(sparkle);
        setTimeout(() => sparkle.remove(), duration * 1000);
    }

    function createBalloon(x, y, duration) {
        const balloon = document.createElement('div');
        balloon.className = 'balloon';
        balloon.innerHTML = 'ðŸŽˆ';
        balloon.style.left = x + 'px';
        balloon.style.top = y + 'px';
        balloon.style.animationDuration = duration + 's';
        document.body.appendChild(balloon);
        setTimeout(() => balloon.remove(), duration * 1000);
    }

    function createStar(x, y, duration) {
        const star = document.createElement('div');
        star.className = 'star';
        star.innerHTML = 'â­';
        star.style.left = x + 'px';
        star.style.top = y + 'px';
        star.style.animationDuration = duration + 's';
        document.body.appendChild(star);
        setTimeout(() => star.remove(), duration * 1000);
    }

    function createLeaf(x, y, duration) {
        const leaf = document.createElement('div');
        leaf.className = 'leaf';
        leaf.innerHTML = 'ðŸƒ';
        leaf.style.left = x + 'px';
        leaf.style.top = y + 'px';
        leaf.style.animationDuration = duration + 's';
        document.body.appendChild(leaf);
        setTimeout(() => leaf.remove(), duration * 1000);
    }

    function showRetryMessage(questionNum) {
        const retryMessage = document.getElementById(`retryMessage${questionNum}`);
        retryMessage.style.display = 'block';
        setTimeout(() => {
            retryMessage.style.display = 'none';
        }, 2000);
    }

    function answer(questionNum, isYes) {
        try {
            if (isYes) {
                // Create animations
                const screenWidth = window.innerWidth;
                const step = screenWidth / 10;
                const duration = Math.random() * 10 + 10;  // Duration between 10-20 seconds
                for (let i = 0; i < 10; i++) {
                    const x = i * step + (step / 2);
                    const y = -100;
                    setTimeout(() => createHeart(x, y, duration), i * 3000);
                    setTimeout(() => createCat(x, y, duration), i * 3000 + 3000);
                    setTimeout(() => createFlower(x, y, duration), i * 3000 + 6000);
                    setTimeout(() => createSparkle(x, y, duration), i * 3000 + 9000);
                    setTimeout(() => createBalloon(x, y, duration), i * 3000 + 12000);
                    setTimeout(() => createStar(x, y, duration), i * 3000 + 15000);
                    setTimeout(() => createLeaf(x, y, duration), i * 3000 + 18000);
                }

                // Hide current question
                const currentQuestionEl = document.getElementById(questionNum === 0 ? 'test-question' : `question${questionNum}`);
                currentQuestionEl.classList.remove('visible');
                
                // Show next question or final message
                setTimeout(() => {
                    if (questionNum === 0) {
                        document.getElementById('question1').classList.add('visible');
                        currentQuestion = 1;
                    } else if (questionNum < 3) {
                        document.getElementById(`question${questionNum + 1}`).classList.add('visible');
                        currentQuestion++;
                    } else {
                        document.getElementById('finalMessage').style.display = 'block';
                    }
                }, 1000);
            } else {
                showRetryMessage(questionNum);
            }
        } catch (error) {
            console.error('Error in answer function:', error);
        }
    }
</script>
